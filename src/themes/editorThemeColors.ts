"use client";

import type { EditorThemeId } from "../store/editorStore";

/**
 * Color palette that maps an editor theme to the app's CSS custom properties.
 * Only the properties that differ from the base palette need to be specified;
 * they are applied as inline overrides on <html>.
 */
interface AppThemeOverride {
  "--bg-deep": string;
  "--bg-primary": string;
  "--bg-surface": string;
  "--bg-elevated": string;
  "--border": string;
  "--border-bright": string;
  "--text": string;
  "--text-secondary": string;
  "--text-muted": string;
  "--accent": string;
  "--accent-hover": string;
  "--accent-dim": string;
  "--accent-glow": string;
  "--accent-text-on": string;
  "--selection-bg": string;
  "--overlay-bg": string;
  "--shadow-dialog": string;
  "--cm-bg": string;
  "--cm-gutter-bg": string;
  "--cm-gutter-border": string;
  "--cm-gutter-text": string;
  "--cm-active-line-bg": string;
  "--cm-active-gutter-bg": string;
  "--cm-selection-bg": string;
  "--green": string;
  "--green-dim": string;
  "--yellow": string;
  "--yellow-dim": string;
  "--red": string;
  "--red-dim": string;
  "--blue": string;
  "--blue-dim": string;
}

type ThemeColorMap = Record<Exclude<EditorThemeId, "auto">, AppThemeOverride>;

const DARK_SEMANTICS = {
  "--green": "#22C55E",
  "--green-dim": "rgba(34, 197, 94, 0.15)",
  "--yellow": "#EAB308",
  "--yellow-dim": "rgba(234, 179, 8, 0.12)",
  "--red": "#EF4444",
  "--red-dim": "rgba(239, 68, 68, 0.12)",
  "--blue": "#3B82F6",
  "--blue-dim": "rgba(59, 130, 246, 0.12)",
} as const;

const LIGHT_SEMANTICS = {
  "--green": "#16A34A",
  "--green-dim": "rgba(22, 163, 74, 0.1)",
  "--yellow": "#CA8A04",
  "--yellow-dim": "rgba(202, 138, 4, 0.1)",
  "--red": "#DC2626",
  "--red-dim": "rgba(220, 38, 38, 0.1)",
  "--blue": "#2563EB",
  "--blue-dim": "rgba(37, 99, 235, 0.1)",
} as const;

const DARK_SHADOW = "0 4px 6px rgba(0,0,0,0.15), 0 24px 60px rgba(0,0,0,0.5)";
const LIGHT_SHADOW = "0 4px 6px rgba(0,0,0,0.05), 0 24px 60px rgba(0,0,0,0.15)";

function dark(o: Omit<AppThemeOverride, keyof typeof DARK_SEMANTICS>): AppThemeOverride {
  return { ...o, ...DARK_SEMANTICS };
}

function light(o: Omit<AppThemeOverride, keyof typeof LIGHT_SEMANTICS>): AppThemeOverride {
  return { ...o, ...LIGHT_SEMANTICS };
}

const EDITOR_THEME_COLORS: ThemeColorMap = {
  oneDark: dark({
    "--bg-deep": "#21252b",
    "--bg-primary": "#282c34",
    "--bg-surface": "#2c313a",
    "--bg-elevated": "#353b45",
    "--border": "#3e4451",
    "--border-bright": "#4b5263",
    "--text": "#abb2bf",
    "--text-secondary": "#9da5b4",
    "--text-muted": "#636d83",
    "--accent": "#61afef",
    "--accent-hover": "#528bcc",
    "--accent-dim": "rgba(97,175,239,0.15)",
    "--accent-glow": "rgba(97,175,239,0.3)",
    "--accent-text-on": "#21252b",
    "--selection-bg": "rgba(97,175,239,0.25)",
    "--overlay-bg": "rgba(33,37,43,0.85)",
    "--shadow-dialog": DARK_SHADOW,
    "--cm-bg": "#282c34",
    "--cm-gutter-bg": "#21252b",
    "--cm-gutter-border": "#3e4451",
    "--cm-gutter-text": "#636d83",
    "--cm-active-line-bg": "rgba(97,175,239,0.06)",
    "--cm-active-gutter-bg": "#2c313a",
    "--cm-selection-bg": "rgba(97,175,239,0.2)",
  }),

  dracula: dark({
    "--bg-deep": "#21222c",
    "--bg-primary": "#282a36",
    "--bg-surface": "#343746",
    "--bg-elevated": "#414558",
    "--border": "#44475a",
    "--border-bright": "#6272a4",
    "--text": "#f8f8f2",
    "--text-secondary": "#d4d4d4",
    "--text-muted": "#6272a4",
    "--accent": "#bd93f9",
    "--accent-hover": "#a67ce6",
    "--accent-dim": "rgba(189,147,249,0.15)",
    "--accent-glow": "rgba(189,147,249,0.3)",
    "--accent-text-on": "#21222c",
    "--selection-bg": "rgba(189,147,249,0.25)",
    "--overlay-bg": "rgba(33,34,44,0.85)",
    "--shadow-dialog": DARK_SHADOW,
    "--cm-bg": "#282a36",
    "--cm-gutter-bg": "#21222c",
    "--cm-gutter-border": "#44475a",
    "--cm-gutter-text": "#6272a4",
    "--cm-active-line-bg": "rgba(189,147,249,0.06)",
    "--cm-active-gutter-bg": "#2c2e3a",
    "--cm-selection-bg": "rgba(189,147,249,0.2)",
  }),

  githubDark: dark({
    "--bg-deep": "#0d1117",
    "--bg-primary": "#161b22",
    "--bg-surface": "#21262d",
    "--bg-elevated": "#30363d",
    "--border": "#21262d",
    "--border-bright": "#30363d",
    "--text": "#e6edf3",
    "--text-secondary": "#c9d1d9",
    "--text-muted": "#8b949e",
    "--accent": "#58a6ff",
    "--accent-hover": "#388bfd",
    "--accent-dim": "rgba(88,166,255,0.15)",
    "--accent-glow": "rgba(88,166,255,0.3)",
    "--accent-text-on": "#0d1117",
    "--selection-bg": "rgba(88,166,255,0.25)",
    "--overlay-bg": "rgba(13,17,23,0.85)",
    "--shadow-dialog": DARK_SHADOW,
    "--cm-bg": "#0d1117",
    "--cm-gutter-bg": "#0d1117",
    "--cm-gutter-border": "#21262d",
    "--cm-gutter-text": "#8b949e",
    "--cm-active-line-bg": "rgba(88,166,255,0.06)",
    "--cm-active-gutter-bg": "#161b22",
    "--cm-selection-bg": "rgba(88,166,255,0.2)",
  }),

  githubLight: light({
    "--bg-deep": "#f6f8fa",
    "--bg-primary": "#ffffff",
    "--bg-surface": "#f0f2f5",
    "--bg-elevated": "#d8dee4",
    "--border": "#d0d7de",
    "--border-bright": "#afb8c1",
    "--text": "#1f2328",
    "--text-secondary": "#424a53",
    "--text-muted": "#656d76",
    "--accent": "#0969da",
    "--accent-hover": "#0550ae",
    "--accent-dim": "rgba(9,105,218,0.1)",
    "--accent-glow": "rgba(9,105,218,0.2)",
    "--accent-text-on": "#ffffff",
    "--selection-bg": "rgba(9,105,218,0.2)",
    "--overlay-bg": "rgba(31,35,40,0.4)",
    "--shadow-dialog": LIGHT_SHADOW,
    "--cm-bg": "#ffffff",
    "--cm-gutter-bg": "#f6f8fa",
    "--cm-gutter-border": "#d0d7de",
    "--cm-gutter-text": "#8c959f",
    "--cm-active-line-bg": "rgba(9,105,218,0.06)",
    "--cm-active-gutter-bg": "#eef1f4",
    "--cm-selection-bg": "rgba(9,105,218,0.15)",
  }),

  gruvboxDark: dark({
    "--bg-deep": "#1d2021",
    "--bg-primary": "#282828",
    "--bg-surface": "#3c3836",
    "--bg-elevated": "#504945",
    "--border": "#3c3836",
    "--border-bright": "#504945",
    "--text": "#ebdbb2",
    "--text-secondary": "#d5c4a1",
    "--text-muted": "#928374",
    "--accent": "#fabd2f",
    "--accent-hover": "#d79921",
    "--accent-dim": "rgba(250,189,47,0.15)",
    "--accent-glow": "rgba(250,189,47,0.3)",
    "--accent-text-on": "#1d2021",
    "--selection-bg": "rgba(250,189,47,0.25)",
    "--overlay-bg": "rgba(29,32,33,0.85)",
    "--shadow-dialog": DARK_SHADOW,
    "--cm-bg": "#282828",
    "--cm-gutter-bg": "#1d2021",
    "--cm-gutter-border": "#3c3836",
    "--cm-gutter-text": "#928374",
    "--cm-active-line-bg": "rgba(250,189,47,0.06)",
    "--cm-active-gutter-bg": "#32302f",
    "--cm-selection-bg": "rgba(250,189,47,0.2)",
  }),

  gruvboxLight: light({
    "--bg-deep": "#f9f5d7",
    "--bg-primary": "#fbf1c7",
    "--bg-surface": "#ebdbb2",
    "--bg-elevated": "#d5c4a1",
    "--border": "#d5c4a1",
    "--border-bright": "#bdae93",
    "--text": "#3c3836",
    "--text-secondary": "#504945",
    "--text-muted": "#928374",
    "--accent": "#b57614",
    "--accent-hover": "#9d6504",
    "--accent-dim": "rgba(181,118,20,0.12)",
    "--accent-glow": "rgba(181,118,20,0.2)",
    "--accent-text-on": "#fbf1c7",
    "--selection-bg": "rgba(181,118,20,0.2)",
    "--overlay-bg": "rgba(60,56,54,0.4)",
    "--shadow-dialog": LIGHT_SHADOW,
    "--cm-bg": "#fbf1c7",
    "--cm-gutter-bg": "#f9f5d7",
    "--cm-gutter-border": "#d5c4a1",
    "--cm-gutter-text": "#928374",
    "--cm-active-line-bg": "rgba(181,118,20,0.06)",
    "--cm-active-gutter-bg": "#f2e5bc",
    "--cm-selection-bg": "rgba(181,118,20,0.15)",
  }),

  materialDark: dark({
    "--bg-deep": "#1a1a2e",
    "--bg-primary": "#212121",
    "--bg-surface": "#2b2b2b",
    "--bg-elevated": "#383838",
    "--border": "#2b2b2b",
    "--border-bright": "#424242",
    "--text": "#eeffff",
    "--text-secondary": "#b0bec5",
    "--text-muted": "#546e7a",
    "--accent": "#82aaff",
    "--accent-hover": "#6690e6",
    "--accent-dim": "rgba(130,170,255,0.15)",
    "--accent-glow": "rgba(130,170,255,0.3)",
    "--accent-text-on": "#212121",
    "--selection-bg": "rgba(130,170,255,0.25)",
    "--overlay-bg": "rgba(33,33,33,0.85)",
    "--shadow-dialog": DARK_SHADOW,
    "--cm-bg": "#212121",
    "--cm-gutter-bg": "#1a1a1a",
    "--cm-gutter-border": "#2b2b2b",
    "--cm-gutter-text": "#546e7a",
    "--cm-active-line-bg": "rgba(130,170,255,0.06)",
    "--cm-active-gutter-bg": "#262626",
    "--cm-selection-bg": "rgba(130,170,255,0.2)",
  }),

  materialLight: light({
    "--bg-deep": "#fafafa",
    "--bg-primary": "#ffffff",
    "--bg-surface": "#eee",
    "--bg-elevated": "#e0e0e0",
    "--border": "#e0e0e0",
    "--border-bright": "#bdbdbd",
    "--text": "#212121",
    "--text-secondary": "#424242",
    "--text-muted": "#757575",
    "--accent": "#6182b8",
    "--accent-hover": "#4e6fa5",
    "--accent-dim": "rgba(97,130,184,0.1)",
    "--accent-glow": "rgba(97,130,184,0.2)",
    "--accent-text-on": "#ffffff",
    "--selection-bg": "rgba(97,130,184,0.2)",
    "--overlay-bg": "rgba(33,33,33,0.4)",
    "--shadow-dialog": LIGHT_SHADOW,
    "--cm-bg": "#ffffff",
    "--cm-gutter-bg": "#fafafa",
    "--cm-gutter-border": "#e0e0e0",
    "--cm-gutter-text": "#9e9e9e",
    "--cm-active-line-bg": "rgba(97,130,184,0.06)",
    "--cm-active-gutter-bg": "#f5f5f5",
    "--cm-selection-bg": "rgba(97,130,184,0.15)",
  }),

  monokai: dark({
    "--bg-deep": "#1e1f1c",
    "--bg-primary": "#272822",
    "--bg-surface": "#3e3d32",
    "--bg-elevated": "#49483e",
    "--border": "#3e3d32",
    "--border-bright": "#75715e",
    "--text": "#f8f8f2",
    "--text-secondary": "#cfcfc2",
    "--text-muted": "#75715e",
    "--accent": "#a6e22e",
    "--accent-hover": "#8cc919",
    "--accent-dim": "rgba(166,226,46,0.15)",
    "--accent-glow": "rgba(166,226,46,0.3)",
    "--accent-text-on": "#272822",
    "--selection-bg": "rgba(166,226,46,0.2)",
    "--overlay-bg": "rgba(39,40,34,0.85)",
    "--shadow-dialog": DARK_SHADOW,
    "--cm-bg": "#272822",
    "--cm-gutter-bg": "#1e1f1c",
    "--cm-gutter-border": "#3e3d32",
    "--cm-gutter-text": "#75715e",
    "--cm-active-line-bg": "rgba(166,226,46,0.06)",
    "--cm-active-gutter-bg": "#2f302a",
    "--cm-selection-bg": "rgba(166,226,46,0.15)",
  }),

  monokaiDimmed: dark({
    "--bg-deep": "#1e1e1e",
    "--bg-primary": "#222222",
    "--bg-surface": "#333333",
    "--bg-elevated": "#444444",
    "--border": "#333333",
    "--border-bright": "#555555",
    "--text": "#c5c8c6",
    "--text-secondary": "#a9abaa",
    "--text-muted": "#6a6a6a",
    "--accent": "#9aa83a",
    "--accent-hover": "#7d8c2d",
    "--accent-dim": "rgba(154,168,58,0.15)",
    "--accent-glow": "rgba(154,168,58,0.3)",
    "--accent-text-on": "#1e1e1e",
    "--selection-bg": "rgba(154,168,58,0.2)",
    "--overlay-bg": "rgba(30,30,30,0.85)",
    "--shadow-dialog": DARK_SHADOW,
    "--cm-bg": "#222222",
    "--cm-gutter-bg": "#1e1e1e",
    "--cm-gutter-border": "#333333",
    "--cm-gutter-text": "#6a6a6a",
    "--cm-active-line-bg": "rgba(154,168,58,0.06)",
    "--cm-active-gutter-bg": "#2a2a2a",
    "--cm-selection-bg": "rgba(154,168,58,0.15)",
  }),

  nord: dark({
    "--bg-deep": "#242933",
    "--bg-primary": "#2e3440",
    "--bg-surface": "#3b4252",
    "--bg-elevated": "#434c5e",
    "--border": "#3b4252",
    "--border-bright": "#4c566a",
    "--text": "#eceff4",
    "--text-secondary": "#d8dee9",
    "--text-muted": "#616e88",
    "--accent": "#88c0d0",
    "--accent-hover": "#6fb3c2",
    "--accent-dim": "rgba(136,192,208,0.15)",
    "--accent-glow": "rgba(136,192,208,0.3)",
    "--accent-text-on": "#2e3440",
    "--selection-bg": "rgba(136,192,208,0.25)",
    "--overlay-bg": "rgba(46,52,64,0.85)",
    "--shadow-dialog": DARK_SHADOW,
    "--cm-bg": "#2e3440",
    "--cm-gutter-bg": "#242933",
    "--cm-gutter-border": "#3b4252",
    "--cm-gutter-text": "#616e88",
    "--cm-active-line-bg": "rgba(136,192,208,0.06)",
    "--cm-active-gutter-bg": "#353c4a",
    "--cm-selection-bg": "rgba(136,192,208,0.2)",
  }),

  solarizedDark: dark({
    "--bg-deep": "#00212b",
    "--bg-primary": "#002b36",
    "--bg-surface": "#073642",
    "--bg-elevated": "#1a4a56",
    "--border": "#073642",
    "--border-bright": "#586e75",
    "--text": "#fdf6e3",
    "--text-secondary": "#eee8d5",
    "--text-muted": "#657b83",
    "--accent": "#2aa198",
    "--accent-hover": "#1e8c84",
    "--accent-dim": "rgba(42,161,152,0.15)",
    "--accent-glow": "rgba(42,161,152,0.3)",
    "--accent-text-on": "#002b36",
    "--selection-bg": "rgba(42,161,152,0.25)",
    "--overlay-bg": "rgba(0,43,54,0.85)",
    "--shadow-dialog": DARK_SHADOW,
    "--cm-bg": "#002b36",
    "--cm-gutter-bg": "#00212b",
    "--cm-gutter-border": "#073642",
    "--cm-gutter-text": "#657b83",
    "--cm-active-line-bg": "rgba(42,161,152,0.06)",
    "--cm-active-gutter-bg": "#04313d",
    "--cm-selection-bg": "rgba(42,161,152,0.2)",
  }),

  solarizedLight: light({
    "--bg-deep": "#fdf6e3",
    "--bg-primary": "#eee8d5",
    "--bg-surface": "#ddd6c1",
    "--bg-elevated": "#c9c2ad",
    "--border": "#d3cbb7",
    "--border-bright": "#b8b0a0",
    "--text": "#073642",
    "--text-secondary": "#586e75",
    "--text-muted": "#93a1a1",
    "--accent": "#268bd2",
    "--accent-hover": "#1a6fb5",
    "--accent-dim": "rgba(38,139,210,0.1)",
    "--accent-glow": "rgba(38,139,210,0.2)",
    "--accent-text-on": "#fdf6e3",
    "--selection-bg": "rgba(38,139,210,0.2)",
    "--overlay-bg": "rgba(7,54,66,0.4)",
    "--shadow-dialog": LIGHT_SHADOW,
    "--cm-bg": "#fdf6e3",
    "--cm-gutter-bg": "#eee8d5",
    "--cm-gutter-border": "#d3cbb7",
    "--cm-gutter-text": "#93a1a1",
    "--cm-active-line-bg": "rgba(38,139,210,0.06)",
    "--cm-active-gutter-bg": "#f5eed8",
    "--cm-selection-bg": "rgba(38,139,210,0.15)",
  }),

  sublime: dark({
    "--bg-deep": "#1e1e1e",
    "--bg-primary": "#252526",
    "--bg-surface": "#333333",
    "--bg-elevated": "#3c3c3c",
    "--border": "#333333",
    "--border-bright": "#474747",
    "--text": "#d4d4d4",
    "--text-secondary": "#b0b0b0",
    "--text-muted": "#6a6a6a",
    "--accent": "#f9ae58",
    "--accent-hover": "#e09840",
    "--accent-dim": "rgba(249,174,88,0.15)",
    "--accent-glow": "rgba(249,174,88,0.3)",
    "--accent-text-on": "#1e1e1e",
    "--selection-bg": "rgba(249,174,88,0.2)",
    "--overlay-bg": "rgba(30,30,30,0.85)",
    "--shadow-dialog": DARK_SHADOW,
    "--cm-bg": "#252526",
    "--cm-gutter-bg": "#1e1e1e",
    "--cm-gutter-border": "#333333",
    "--cm-gutter-text": "#6a6a6a",
    "--cm-active-line-bg": "rgba(249,174,88,0.06)",
    "--cm-active-gutter-bg": "#2a2a2a",
    "--cm-selection-bg": "rgba(249,174,88,0.15)",
  }),

  tokyoNight: dark({
    "--bg-deep": "#16161e",
    "--bg-primary": "#1a1b26",
    "--bg-surface": "#24283b",
    "--bg-elevated": "#2f3549",
    "--border": "#24283b",
    "--border-bright": "#3b4261",
    "--text": "#c0caf5",
    "--text-secondary": "#a9b1d6",
    "--text-muted": "#565f89",
    "--accent": "#7aa2f7",
    "--accent-hover": "#5d8ae6",
    "--accent-dim": "rgba(122,162,247,0.15)",
    "--accent-glow": "rgba(122,162,247,0.3)",
    "--accent-text-on": "#1a1b26",
    "--selection-bg": "rgba(122,162,247,0.25)",
    "--overlay-bg": "rgba(26,27,38,0.85)",
    "--shadow-dialog": DARK_SHADOW,
    "--cm-bg": "#1a1b26",
    "--cm-gutter-bg": "#16161e",
    "--cm-gutter-border": "#24283b",
    "--cm-gutter-text": "#565f89",
    "--cm-active-line-bg": "rgba(122,162,247,0.06)",
    "--cm-active-gutter-bg": "#1f2030",
    "--cm-selection-bg": "rgba(122,162,247,0.2)",
  }),

  tokyoNightDay: light({
    "--bg-deep": "#e1e2e7",
    "--bg-primary": "#d5d6db",
    "--bg-surface": "#c4c5ca",
    "--bg-elevated": "#b4b5ba",
    "--border": "#c4c5ca",
    "--border-bright": "#a1a2a7",
    "--text": "#3760bf",
    "--text-secondary": "#4e6fbd",
    "--text-muted": "#8990b3",
    "--accent": "#2e7de9",
    "--accent-hover": "#1a6ad4",
    "--accent-dim": "rgba(46,125,233,0.1)",
    "--accent-glow": "rgba(46,125,233,0.2)",
    "--accent-text-on": "#e1e2e7",
    "--selection-bg": "rgba(46,125,233,0.2)",
    "--overlay-bg": "rgba(55,96,191,0.3)",
    "--shadow-dialog": LIGHT_SHADOW,
    "--cm-bg": "#e1e2e7",
    "--cm-gutter-bg": "#d5d6db",
    "--cm-gutter-border": "#c4c5ca",
    "--cm-gutter-text": "#8990b3",
    "--cm-active-line-bg": "rgba(46,125,233,0.06)",
    "--cm-active-gutter-bg": "#d9dadf",
    "--cm-selection-bg": "rgba(46,125,233,0.15)",
  }),

  tokyoNightStorm: dark({
    "--bg-deep": "#1f2335",
    "--bg-primary": "#24283b",
    "--bg-surface": "#2f3549",
    "--bg-elevated": "#3b4261",
    "--border": "#2f3549",
    "--border-bright": "#3b4261",
    "--text": "#c0caf5",
    "--text-secondary": "#a9b1d6",
    "--text-muted": "#565f89",
    "--accent": "#7aa2f7",
    "--accent-hover": "#5d8ae6",
    "--accent-dim": "rgba(122,162,247,0.15)",
    "--accent-glow": "rgba(122,162,247,0.3)",
    "--accent-text-on": "#24283b",
    "--selection-bg": "rgba(122,162,247,0.25)",
    "--overlay-bg": "rgba(36,40,59,0.85)",
    "--shadow-dialog": DARK_SHADOW,
    "--cm-bg": "#24283b",
    "--cm-gutter-bg": "#1f2335",
    "--cm-gutter-border": "#2f3549",
    "--cm-gutter-text": "#565f89",
    "--cm-active-line-bg": "rgba(122,162,247,0.06)",
    "--cm-active-gutter-bg": "#292e42",
    "--cm-selection-bg": "rgba(122,162,247,0.2)",
  }),

  vscodeDark: dark({
    "--bg-deep": "#1e1e1e",
    "--bg-primary": "#252526",
    "--bg-surface": "#2d2d2d",
    "--bg-elevated": "#3c3c3c",
    "--border": "#2d2d2d",
    "--border-bright": "#474747",
    "--text": "#d4d4d4",
    "--text-secondary": "#b0b0b0",
    "--text-muted": "#6a6a6a",
    "--accent": "#569cd6",
    "--accent-hover": "#4089c3",
    "--accent-dim": "rgba(86,156,214,0.15)",
    "--accent-glow": "rgba(86,156,214,0.3)",
    "--accent-text-on": "#1e1e1e",
    "--selection-bg": "rgba(86,156,214,0.25)",
    "--overlay-bg": "rgba(30,30,30,0.85)",
    "--shadow-dialog": DARK_SHADOW,
    "--cm-bg": "#1e1e1e",
    "--cm-gutter-bg": "#1e1e1e",
    "--cm-gutter-border": "#2d2d2d",
    "--cm-gutter-text": "#6a6a6a",
    "--cm-active-line-bg": "rgba(86,156,214,0.06)",
    "--cm-active-gutter-bg": "#252526",
    "--cm-selection-bg": "rgba(86,156,214,0.2)",
  }),

  vscodeLight: light({
    "--bg-deep": "#f3f3f3",
    "--bg-primary": "#ffffff",
    "--bg-surface": "#ececec",
    "--bg-elevated": "#dddddd",
    "--border": "#e0e0e0",
    "--border-bright": "#c8c8c8",
    "--text": "#1e1e1e",
    "--text-secondary": "#444444",
    "--text-muted": "#767676",
    "--accent": "#0066b8",
    "--accent-hover": "#005299",
    "--accent-dim": "rgba(0,102,184,0.1)",
    "--accent-glow": "rgba(0,102,184,0.2)",
    "--accent-text-on": "#ffffff",
    "--selection-bg": "rgba(0,102,184,0.2)",
    "--overlay-bg": "rgba(30,30,30,0.4)",
    "--shadow-dialog": LIGHT_SHADOW,
    "--cm-bg": "#ffffff",
    "--cm-gutter-bg": "#f3f3f3",
    "--cm-gutter-border": "#e0e0e0",
    "--cm-gutter-text": "#999999",
    "--cm-active-line-bg": "rgba(0,102,184,0.06)",
    "--cm-active-gutter-bg": "#f0f0f0",
    "--cm-selection-bg": "rgba(0,102,184,0.15)",
  }),

  xcodeDark: dark({
    "--bg-deep": "#1f1f24",
    "--bg-primary": "#292a30",
    "--bg-surface": "#393b44",
    "--bg-elevated": "#494b55",
    "--border": "#393b44",
    "--border-bright": "#53555e",
    "--text": "#dfdfe0",
    "--text-secondary": "#b0b0b2",
    "--text-muted": "#7f8c98",
    "--accent": "#ff7ab2",
    "--accent-hover": "#e6619c",
    "--accent-dim": "rgba(255,122,178,0.15)",
    "--accent-glow": "rgba(255,122,178,0.3)",
    "--accent-text-on": "#292a30",
    "--selection-bg": "rgba(255,122,178,0.2)",
    "--overlay-bg": "rgba(41,42,48,0.85)",
    "--shadow-dialog": DARK_SHADOW,
    "--cm-bg": "#292a30",
    "--cm-gutter-bg": "#1f1f24",
    "--cm-gutter-border": "#393b44",
    "--cm-gutter-text": "#7f8c98",
    "--cm-active-line-bg": "rgba(255,122,178,0.06)",
    "--cm-active-gutter-bg": "#31323a",
    "--cm-selection-bg": "rgba(255,122,178,0.15)",
  }),

  xcodeLight: light({
    "--bg-deep": "#f5f5f5",
    "--bg-primary": "#ffffff",
    "--bg-surface": "#e8e8e8",
    "--bg-elevated": "#d6d6d6",
    "--border": "#e0e0e0",
    "--border-bright": "#c0c0c0",
    "--text": "#262626",
    "--text-secondary": "#4a4a4a",
    "--text-muted": "#8a8a8a",
    "--accent": "#0b4f79",
    "--accent-hover": "#073d5f",
    "--accent-dim": "rgba(11,79,121,0.1)",
    "--accent-glow": "rgba(11,79,121,0.2)",
    "--accent-text-on": "#ffffff",
    "--selection-bg": "rgba(11,79,121,0.2)",
    "--overlay-bg": "rgba(38,38,38,0.4)",
    "--shadow-dialog": LIGHT_SHADOW,
    "--cm-bg": "#ffffff",
    "--cm-gutter-bg": "#f5f5f5",
    "--cm-gutter-border": "#e0e0e0",
    "--cm-gutter-text": "#aaaaaa",
    "--cm-active-line-bg": "rgba(11,79,121,0.06)",
    "--cm-active-gutter-bg": "#f0f0f0",
    "--cm-selection-bg": "rgba(11,79,121,0.15)",
  }),

  androidstudio: dark({
    "--bg-deep": "#1c1c1c",
    "--bg-primary": "#282b2e",
    "--bg-surface": "#353839",
    "--bg-elevated": "#424546",
    "--border": "#353839",
    "--border-bright": "#505355",
    "--text": "#a9b7c6",
    "--text-secondary": "#8c9bab",
    "--text-muted": "#606366",
    "--accent": "#cc7832",
    "--accent-hover": "#b3651f",
    "--accent-dim": "rgba(204,120,50,0.15)",
    "--accent-glow": "rgba(204,120,50,0.3)",
    "--accent-text-on": "#1c1c1c",
    "--selection-bg": "rgba(204,120,50,0.2)",
    "--overlay-bg": "rgba(40,43,46,0.85)",
    "--shadow-dialog": DARK_SHADOW,
    "--cm-bg": "#282b2e",
    "--cm-gutter-bg": "#1c1c1c",
    "--cm-gutter-border": "#353839",
    "--cm-gutter-text": "#606366",
    "--cm-active-line-bg": "rgba(204,120,50,0.06)",
    "--cm-active-gutter-bg": "#2e3134",
    "--cm-selection-bg": "rgba(204,120,50,0.15)",
  }),

  atomone: dark({
    "--bg-deep": "#21252b",
    "--bg-primary": "#282c34",
    "--bg-surface": "#2c313a",
    "--bg-elevated": "#353b45",
    "--border": "#3e4451",
    "--border-bright": "#4b5263",
    "--text": "#abb2bf",
    "--text-secondary": "#9da5b4",
    "--text-muted": "#636d83",
    "--accent": "#61afef",
    "--accent-hover": "#528bcc",
    "--accent-dim": "rgba(97,175,239,0.15)",
    "--accent-glow": "rgba(97,175,239,0.3)",
    "--accent-text-on": "#21252b",
    "--selection-bg": "rgba(97,175,239,0.25)",
    "--overlay-bg": "rgba(33,37,43,0.85)",
    "--shadow-dialog": DARK_SHADOW,
    "--cm-bg": "#282c34",
    "--cm-gutter-bg": "#21252b",
    "--cm-gutter-border": "#3e4451",
    "--cm-gutter-text": "#636d83",
    "--cm-active-line-bg": "rgba(97,175,239,0.06)",
    "--cm-active-gutter-bg": "#2c313a",
    "--cm-selection-bg": "rgba(97,175,239,0.2)",
  }),

  aura: dark({
    "--bg-deep": "#15141b",
    "--bg-primary": "#1c1b27",
    "--bg-surface": "#2a2938",
    "--bg-elevated": "#3b3a4b",
    "--border": "#2a2938",
    "--border-bright": "#3b3a4b",
    "--text": "#edecee",
    "--text-secondary": "#bdbdbe",
    "--text-muted": "#6d6d6e",
    "--accent": "#a277ff",
    "--accent-hover": "#8a5de6",
    "--accent-dim": "rgba(162,119,255,0.15)",
    "--accent-glow": "rgba(162,119,255,0.3)",
    "--accent-text-on": "#15141b",
    "--selection-bg": "rgba(162,119,255,0.25)",
    "--overlay-bg": "rgba(21,20,27,0.85)",
    "--shadow-dialog": DARK_SHADOW,
    "--cm-bg": "#15141b",
    "--cm-gutter-bg": "#15141b",
    "--cm-gutter-border": "#2a2938",
    "--cm-gutter-text": "#6d6d6e",
    "--cm-active-line-bg": "rgba(162,119,255,0.06)",
    "--cm-active-gutter-bg": "#1e1d2a",
    "--cm-selection-bg": "rgba(162,119,255,0.2)",
  }),

  bbedit: light({
    "--bg-deep": "#f5f5f5",
    "--bg-primary": "#ffffff",
    "--bg-surface": "#ebebeb",
    "--bg-elevated": "#d6d6d6",
    "--border": "#e0e0e0",
    "--border-bright": "#c0c0c0",
    "--text": "#000000",
    "--text-secondary": "#333333",
    "--text-muted": "#888888",
    "--accent": "#1c00cf",
    "--accent-hover": "#1400a8",
    "--accent-dim": "rgba(28,0,207,0.1)",
    "--accent-glow": "rgba(28,0,207,0.2)",
    "--accent-text-on": "#ffffff",
    "--selection-bg": "rgba(28,0,207,0.15)",
    "--overlay-bg": "rgba(0,0,0,0.35)",
    "--shadow-dialog": LIGHT_SHADOW,
    "--cm-bg": "#ffffff",
    "--cm-gutter-bg": "#f5f5f5",
    "--cm-gutter-border": "#e0e0e0",
    "--cm-gutter-text": "#aaaaaa",
    "--cm-active-line-bg": "rgba(28,0,207,0.05)",
    "--cm-active-gutter-bg": "#f0f0f0",
    "--cm-selection-bg": "rgba(28,0,207,0.12)",
  }),

  bespin: dark({
    "--bg-deep": "#28211c",
    "--bg-primary": "#2a211c",
    "--bg-surface": "#3e3229",
    "--bg-elevated": "#524436",
    "--border": "#3e3229",
    "--border-bright": "#5e4f3e",
    "--text": "#baae9e",
    "--text-secondary": "#9e9181",
    "--text-muted": "#666666",
    "--accent": "#cf6a4c",
    "--accent-hover": "#b85a3e",
    "--accent-dim": "rgba(207,106,76,0.15)",
    "--accent-glow": "rgba(207,106,76,0.3)",
    "--accent-text-on": "#28211c",
    "--selection-bg": "rgba(207,106,76,0.2)",
    "--overlay-bg": "rgba(40,33,28,0.85)",
    "--shadow-dialog": DARK_SHADOW,
    "--cm-bg": "#2a211c",
    "--cm-gutter-bg": "#28211c",
    "--cm-gutter-border": "#3e3229",
    "--cm-gutter-text": "#666666",
    "--cm-active-line-bg": "rgba(207,106,76,0.06)",
    "--cm-active-gutter-bg": "#302820",
    "--cm-selection-bg": "rgba(207,106,76,0.15)",
  }),

  copilot: dark({
    "--bg-deep": "#1b1f23",
    "--bg-primary": "#22272e",
    "--bg-surface": "#2d333b",
    "--bg-elevated": "#373e47",
    "--border": "#2d333b",
    "--border-bright": "#444c56",
    "--text": "#adbac7",
    "--text-secondary": "#8b949e",
    "--text-muted": "#636e7b",
    "--accent": "#539bf5",
    "--accent-hover": "#3d8be2",
    "--accent-dim": "rgba(83,155,245,0.15)",
    "--accent-glow": "rgba(83,155,245,0.3)",
    "--accent-text-on": "#1b1f23",
    "--selection-bg": "rgba(83,155,245,0.25)",
    "--overlay-bg": "rgba(27,31,35,0.85)",
    "--shadow-dialog": DARK_SHADOW,
    "--cm-bg": "#22272e",
    "--cm-gutter-bg": "#1b1f23",
    "--cm-gutter-border": "#2d333b",
    "--cm-gutter-text": "#636e7b",
    "--cm-active-line-bg": "rgba(83,155,245,0.06)",
    "--cm-active-gutter-bg": "#272c34",
    "--cm-selection-bg": "rgba(83,155,245,0.2)",
  }),

  darcula: dark({
    "--bg-deep": "#1e1e1e",
    "--bg-primary": "#2b2b2b",
    "--bg-surface": "#3c3f41",
    "--bg-elevated": "#4e5254",
    "--border": "#3c3f41",
    "--border-bright": "#555555",
    "--text": "#a9b7c6",
    "--text-secondary": "#8c9bab",
    "--text-muted": "#606366",
    "--accent": "#ffc66d",
    "--accent-hover": "#e6b05a",
    "--accent-dim": "rgba(255,198,109,0.15)",
    "--accent-glow": "rgba(255,198,109,0.3)",
    "--accent-text-on": "#1e1e1e",
    "--selection-bg": "rgba(255,198,109,0.2)",
    "--overlay-bg": "rgba(43,43,43,0.85)",
    "--shadow-dialog": DARK_SHADOW,
    "--cm-bg": "#2b2b2b",
    "--cm-gutter-bg": "#1e1e1e",
    "--cm-gutter-border": "#3c3f41",
    "--cm-gutter-text": "#606366",
    "--cm-active-line-bg": "rgba(255,198,109,0.06)",
    "--cm-active-gutter-bg": "#313335",
    "--cm-selection-bg": "rgba(255,198,109,0.15)",
  }),

  eclipse: light({
    "--bg-deep": "#f0f0f0",
    "--bg-primary": "#ffffff",
    "--bg-surface": "#e8e8e8",
    "--bg-elevated": "#d4d4d4",
    "--border": "#e0e0e0",
    "--border-bright": "#c0c0c0",
    "--text": "#1e1e1e",
    "--text-secondary": "#444444",
    "--text-muted": "#888888",
    "--accent": "#7f0055",
    "--accent-hover": "#660044",
    "--accent-dim": "rgba(127,0,85,0.1)",
    "--accent-glow": "rgba(127,0,85,0.2)",
    "--accent-text-on": "#ffffff",
    "--selection-bg": "rgba(127,0,85,0.15)",
    "--overlay-bg": "rgba(30,30,30,0.4)",
    "--shadow-dialog": LIGHT_SHADOW,
    "--cm-bg": "#ffffff",
    "--cm-gutter-bg": "#f0f0f0",
    "--cm-gutter-border": "#e0e0e0",
    "--cm-gutter-text": "#999999",
    "--cm-active-line-bg": "rgba(127,0,85,0.05)",
    "--cm-active-gutter-bg": "#f5f5f5",
    "--cm-selection-bg": "rgba(127,0,85,0.12)",
  }),

  okaidia: dark({
    "--bg-deep": "#1e1f1c",
    "--bg-primary": "#272822",
    "--bg-surface": "#3e3d32",
    "--bg-elevated": "#49483e",
    "--border": "#3e3d32",
    "--border-bright": "#75715e",
    "--text": "#f8f8f2",
    "--text-secondary": "#cfcfc2",
    "--text-muted": "#75715e",
    "--accent": "#66d9ef",
    "--accent-hover": "#4dc4da",
    "--accent-dim": "rgba(102,217,239,0.15)",
    "--accent-glow": "rgba(102,217,239,0.3)",
    "--accent-text-on": "#272822",
    "--selection-bg": "rgba(102,217,239,0.2)",
    "--overlay-bg": "rgba(39,40,34,0.85)",
    "--shadow-dialog": DARK_SHADOW,
    "--cm-bg": "#272822",
    "--cm-gutter-bg": "#1e1f1c",
    "--cm-gutter-border": "#3e3d32",
    "--cm-gutter-text": "#75715e",
    "--cm-active-line-bg": "rgba(102,217,239,0.06)",
    "--cm-active-gutter-bg": "#2f302a",
    "--cm-selection-bg": "rgba(102,217,239,0.15)",
  }),
};

const ALL_CSS_PROPS = Object.keys(EDITOR_THEME_COLORS.dracula) as (keyof AppThemeOverride)[];

/**
 * Applies the editor theme's colors as CSS custom property overrides on <html>.
 * When themeId is "auto" or adaptAppTheme is false, clears all overrides.
 */
export function applyAppThemeOverride(themeId: EditorThemeId, adaptAppTheme: boolean): void {
  const root = document.documentElement;

  if (!adaptAppTheme || themeId === "auto") {
    for (const prop of ALL_CSS_PROPS) {
      root.style.removeProperty(prop);
    }
    return;
  }

  const colors = EDITOR_THEME_COLORS[themeId];
  for (const prop of ALL_CSS_PROPS) {
    root.style.setProperty(prop, colors[prop]);
  }
}
